# DeepSeekDog 项目详细说明

## 项目简介

DeepSeekDog 是一个基于**语音控制的四足机器人系统**，结合了**DeepSeek AI大脑**和**Unitree Go2机器狗**，实现了多模态智能交互。

### 核心特性
- 🎯 **语音控制**：支持中英文双语语音识别
- 👁️ **AI视觉**：YOLOv5实时目标检测
- 📡 **激光雷达**：3D环境建图和障碍物检测
- 🌐 **Web界面**：实时视频流和远程控制
- 🤖 **多模态交互**：语音+视觉+动作一体化

## 系统架构

### 硬件组成
```
Unitree Go2 四足机器人
├── 激光雷达传感器
├── 高清摄像头
├── 麦克风阵列
└── 运动控制系统
```

### 软件架构
```
┌─────────────────┐
│   Web界面        │  Flask + SocketIO
├─────────────────┤
│   语音控制       │  SpeechRecognition + Vosk
├─────────────────┤
│   AI视觉         │  YOLOv5 + PyTorch
├─────────────────┤
│   雷达处理       │  PointCloud2 + Matplotlib
├─────────────────┤
│   机器人控制     │  Unitree SDK
└─────────────────┘
```

## 文件结构详解

### 主程序文件
- **`dsd_unitree.py`** - 完整功能版（推荐）
  - 集成激光雷达、AI视觉、Web界面
  - 支持所有高级功能

- **`dsd_voice.py`** - 基础语音版
  - 仅语音控制功能
  - 适合基础测试

- **`dsd_voice_video.py`** - 语音+视频版
  - 语音控制+视频流
  - 无激光雷达功能

### 测试文件
- `test_img_detect.py` - 图像检测测试
- `test_lidar_range_info.py` - 激光雷达测距测试
- `test_point_cloud.py` - 点云数据测试
- `test_slam.py` - SLAM功能测试
- `test_voice_rec.py` - 语音识别测试

### Web界面文件
```
static/
├── bootstrap.min.css      # Bootstrap样式
├── bootstrap-icons.css    # 图标库
├── socket.io.js          # 实时通信
└── photos/               # 照片存储
templates/
└── index.html            # Web界面模板
```

## 核心模块详解

### 1. LidarProcessor - 激光雷达处理
**功能**：处理激光雷达点云数据
- 订阅激光雷达话题：`rt/utlidar/cloud_deskewed`
- 实时3D环境建图
- 障碍物距离检测
- 生成彩色点云图（按距离分层显示）

**技术细节**：
- 将点云数据转换为3D坐标
- 按距离（0.5米间隔）分层着色：
  - 0-0.5m：红色（最近）
  - 0.5-1.0m：橙色
  - 1.0-1.5m：黄色
  - 1.5-2.0m：黄绿色
  - 2.0-2.5m：绿色
  - 2.5-3.0m：蓝绿色
  - 3.0m+：蓝色（最远）

### 2. OfflineYOLODetector - AI视觉检测
**功能**：离线目标检测
- 基于YOLOv5模型
- 支持80种物体识别
- 中英文标签转换
- 置信度过滤（>50%）

**支持识别的物体**（部分）：
- 人、汽车、椅子、书、手机
- 杯子、笔记本电脑、狗、猫
- 瓶子、键盘、鼠标、电视等

### 3. VoiceControl - 语音控制核心
**功能**：语音命令解析与执行
- 双模式语音识别：在线(Google) + 离线(Vosk)
- 智能命令映射系统
- 实时语音反馈
- 网络状态自动切换

### 4. WebInterface - Web界面
**功能**：提供Web控制界面
- 实时视频流显示
- 语音命令输入框
- 照片管理功能
- 系统状态监控
- Socket.IO实时通信

## 命令系统详解

### 运动控制命令
| 中文命令 | 英文命令 | 对应动作 | 说明 |
|----------|----------|----------|------|
| 前进 | forward | 向前移动 | 0.3m/s速度 |
| 后退 | backward | 向后移动 | 0.3m/s速度 |
| 左移 | left | 向左移动 | 0.3m/s速度 |
| 右移 | right | 向右移动 | 0.3m/s速度 |
| 旋转 | turn | 原地旋转 | 顺时针旋转 |
| 站立 | stand | 站立姿势 | 平衡站立 |
| 坐下 | sit | 坐下姿势 | 休息姿势 |
| 停止 | stop | 停止移动 | 紧急停止 |

### AI功能命令
| 命令 | 功能描述 |
|------|----------|
| 拍照 | 拍摄当前画面 |
| 识别物品 | AI分析照片中的物体 |
| 扫描环境 | 激光雷达环境扫描 |
| 障碍物检测 | 检测前方障碍物 |
| 前方障碍物 | 实时障碍物距离报告 |
| 调试模式 | 开启详细日志 |
| 正常模式 | 关闭详细日志 |

### 系统命令
| 命令 | 功能 |
|------|------|
| 退出 | 安全退出系统 |

## 使用方法

### 1. 环境准备
```bash
# 安装依赖
pip install -r requirements.txt

# 确保YOLOv5仓库存在
git clone https://github.com/ultralytics/yolov5.git

# 下载YOLOv5模型权重
wget https://github.com/ultralytics/yolov5/releases/download/v6.0/yolov5s.pt
```

### 2. 启动系统
```bash
# 完整功能版（推荐）
python dsd_unitree.py eth0

# 基础语音版
python dsd_voice.py eth0

# 语音+视频版
python dsd_voice_video.py eth0
```

### 3. 网络接口说明
- `eth0`：以太网接口
- `wlan0`：WiFi接口
- 根据实际网络环境选择

### 4. 语音交互
1. 启动后等待系统提示"系统已启动，准备就绪"
2. 直接说出命令，如"前进"、"拍照"
3. 系统会语音确认命令执行

### 5. Web界面
1. 启动后访问 http://localhost:5000
2. 实时查看摄像头画面
3. 使用文字输入框发送命令
4. 查看历史照片

## 技术规格

### 硬件要求
- **机器人**：Unitree Go2 或兼容型号
- **计算设备**：NVIDIA Jetson 或 x86_64 PC
- **网络**：千兆以太网或高速WiFi

### 软件环境
```python
# 核心依赖
unitree_sdk2py>=1.0      # Unitree机器人SDK
speechrecognition>=3.8   # 语音识别
vosk>=0.3.45            # 离线语音识别
edge_tts>=6.1.0         # 文本转语音
yolov5>=6.0             # 目标检测
torch>=1.9.0            # PyTorch深度学习
flask>=2.0.0            # Web框架
opencv-python>=4.5      # 计算机视觉
numpy>=1.21.0           # 数值计算
matplotlib>=3.5.0       # 数据可视化
```

### 性能指标
- **语音识别准确率**：>95%（安静环境）
- **目标检测速度**：~100ms/帧
- **激光雷达扫描**：实时10Hz
- **Web界面延迟**：<100ms

## 故障排除

### 常见问题
1. **网络连接失败**
   - 检查网络接口名称
   - 确认机器人IP可达

2. **语音识别失败**
   - 检查麦克风权限
   - 确认音频设备正常

3. **YOLO检测失败**
   - 检查模型文件是否存在
   - 确认图像输入正常

4. **激光雷达无数据**
   - 检查雷达连接
   - 确认话题名称正确

### 调试方法
1. 使用`调试模式`获取详细日志
2. 查看控制台输出信息
3. 检查Web界面状态页面

## 扩展开发

### 添加新命令
1. 在`command_map`中添加正则表达式
2. 在`execute_action`中实现对应功能
3. 测试新命令功能

### 集成新AI模型
1. 替换YOLOv5为其他检测模型
2. 更新标签映射表
3. 调整检测阈值

### Web界面定制
1. 修改`templates/index.html`
2. 更新`static/`中的样式文件
3. 添加新的Socket.IO事件

## 安全注意事项

1. **操作安全**
   - 确保操作环境安全
   - 保持安全距离
   - 随时准备紧急停止

2. **网络安全**
   - 使用安全网络
   - 限制Web访问权限
   - 定期更新系统

3. **数据安全**
   - 加密敏感数据传输
   - 定期清理缓存照片
   - 保护用户隐私

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 联系方式

- 项目地址：https://github.com/zdwalter/DeepSeekDog
- 问题反馈：请提交GitHub Issue

---

**最后更新：2025年7月17日**